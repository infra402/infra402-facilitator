# Post-Settlement Hooks Configuration
#
# For detailed documentation and examples, see: docs/HOOKS_IMPLEMENTATION.md
#
# This file defines custom contract calls that execute atomically with settlement
# transfers via Multicall3.

[hooks]
# Global enable/disable flag for the hook system
enabled = true

# Allow hook calls to fail without reverting the entire batch
# When true: Individual hook calls can fail without reverting transfers
# When false: Any hook failure reverts the entire batch (safer default)
allow_hook_failure = true

# Optional: Path to custom hooks file (disabled by default)
# Uncomment to enable custom hooks (see hooks-custom.toml.example)
custom_hooks_file = "hooks-custom.toml"

# ============================================================================
# Hook Definitions (shared across all networks)
# ============================================================================
# Define your hooks here with function signatures and parameters.
# Contract addresses are specified per-network in [hooks.networks.xxx.contracts].
#
# Hook format:
#   [hooks.definitions.hook_name]
#   enabled = true
#   description = "What this hook does"
#   function_signature = "functionName(type1,type2,...)"
#   gas_limit = 100000
#   [[hooks.definitions.hook_name.parameters]]
#     type = "solidity_type"
#     source = { source_type = "payment|runtime|config|static", field = "..." }
#
# See docs/HOOKS_IMPLEMENTATION.md for complete examples.

[hooks.definitions]
# Add your hook definitions here
# Production hooks that are shared across all networks go here
#
# For custom/test hooks, use hooks-custom.toml (see hooks-custom.toml.example)

# UpDown402 betting callback hook for BSC Testnet
[hooks.definitions.up_down_402]
enabled = true
description = "UpDown402 betting callback with EIP-3009 payment"
function_signature = "onBetPlaced(address,address,uint256,uint256,uint256,bytes32,uint8,bytes32,bytes32)"

# Parameter 1: paymentToken (EIP-3009 token contract address)
[[hooks.definitions.up_down_402.parameters]]
type = "address"
source = { source_type = "payment", field = "contractaddress" }

# Parameter 2: from (payer address)
[[hooks.definitions.up_down_402.parameters]]
type = "address"
source = { source_type = "payment", field = "from" }

# Parameter 3: value (bet amount)
[[hooks.definitions.up_down_402.parameters]]
type = "uint256"
source = { source_type = "payment", field = "value" }

# Parameter 4: validAfter (EIP-3009 timestamp)
[[hooks.definitions.up_down_402.parameters]]
type = "uint256"
source = { source_type = "payment", field = "validafter" }

# Parameter 5: validBefore (EIP-3009 timestamp)
[[hooks.definitions.up_down_402.parameters]]
type = "uint256"
source = { source_type = "payment", field = "validbefore" }

# Parameter 6: nonce (EIP-3009 unique nonce)
[[hooks.definitions.up_down_402.parameters]]
type = "bytes32"
source = { source_type = "payment", field = "nonce" }

# Parameter 7: v (signature component)
[[hooks.definitions.up_down_402.parameters]]
type = "uint8"
source = { source_type = "payment", field = "signaturev" }

# Parameter 8: r (signature component)
[[hooks.definitions.up_down_402.parameters]]
type = "bytes32"
source = { source_type = "payment", field = "signaturer" }

# Parameter 9: s (signature component)
[[hooks.definitions.up_down_402.parameters]]
type = "bytes32"
source = { source_type = "payment", field = "signatures" }

# ============================================================================
# Custom Network Configurations
# ============================================================================
# Configure custom hooks for specific networks and recipients.

# BSC Testnet configuration for UpDown402
[hooks.networks.bsc]
enabled = true

# Recipient address → hook names mapping for this network
[hooks.networks.bsc.mappings]
"0x3949CA149979a0Fe89aC99Dad410855e13bc3c50" = ["up_down_402"]

# Hook name → (destination → contract address) mapping for this network
# Format: [hooks.networks.<network>.contracts.<hook_name>]
# "<destination_address>" = "<contract_address>"
[hooks.networks.bsc.contracts.up_down_402]
"0x3949CA149979a0Fe89aC99Dad410855e13bc3c50" = "0x3949CA149979a0Fe89aC99Dad410855e13bc3c50"

# Token filters: Only trigger for XBNB payments on BSC mainnet
[hooks.networks.bsc.token_filters]
up_down_402 = ["xbnb"]

# BSC Testnet configuration for UpDown402
[hooks.networks.bsc-testnet]
enabled = true

# Recipient address → hook names mapping for this network
[hooks.networks.bsc-testnet.mappings]
"0x5157d93579812b749e5547a0bF60B26b5Ac8f104" = ["up_down_402"]

# Hook name → (destination → contract address) mapping for this network
# Format: [hooks.networks.<network>.contracts.<hook_name>]
# "<destination_address>" = "<contract_address>"
[hooks.networks.bsc-testnet.contracts.up_down_402]
"0x5157d93579812b749e5547a0bF60B26b5Ac8f104" = "0x5157d93579812b749e5547a0bF60B26b5Ac8f104"

# Token filters: Only trigger for XBNB payments on BSC testnet
[hooks.networks.bsc-testnet.token_filters]
up_down_402 = ["xbnb"]
